ECP BREARD — Dam-break example (channel)

This sets up a 2-D dam-break in a long rectangular channel with no-flux side walls (lateral) and no-flux at the right boundary, runs IMEX to produce a NetCDF, and post-processes the centreline flow height to PNGs and a movie (equal x–y scale, grey fill under the surface, blue outline).

Scripts used: create_dambreak_static.py (setup + IMEX_SfloW2D.inp), height_summary_nc.py (centreline height → PNGs + MP4/GIF), clean_folder.py (optional tidy), IMEX_SfloW2D.template (input template).

Setup script arguments (create_dambreak_static.py): channel-length (m) = total x-length; channel-width (m) = y-width; nx, ny = grid cells; bed-length (m) = initial dam thickness in x; bed-height (m) = initial dam height in z; run-name = output stem.

Generate setup (example: 3.0 m channel, 0.15 m width, dam 0.20 m × 0.40 m at the left)
python create_dambreak_static.py --channel-length 3.0 --channel-width 0.15 --nx 600 --ny 60 --bed-length 0.20 --bed-height 0.40 --run-name dambreak2D
Writes: IMEX_SfloW2D.inp, topography_dem.asc, example_2D_0000.q_2d (and a preview PNG).

Link solver in this folder (once)
ln -s ../../bin/IMEX_SfloW2D .

Run the solver with the input file produced by setup
./IMEX_SfloW2D IMEX_SfloW2D.inp
Produces: dambreak2D.nc (plus snapshots).

Post-process: centreline height along y = center_fraction (0=bottom, 0.5=mid, 1=top); add --animate for a movie
python height_summary_nc.py dambreak2D.nc --center_fraction 0.5 --animate
Outputs: frames/dambreak2D_hcenter_####.png and dambreak2D_height_movie.mp4 (or GIF if ffmpeg not available).

NOTE (MP4 support): if needed install ffmpeg bindings and system ffmpeg
pip install -U "imageio[ffmpeg]" imageio-ffmpeg
sudo apt-get update && sudo apt-get install -y ffmpeg

Clean the folder (dry-run first; then actually delete non-essentials)
python clean_folder.py
python clean_folder.py --apply

Geometry & boundaries: side walls are no-flux; right boundary (x-max) is no-flux; initial dam occupies the upstream segment. Plots enforce 1:1 axis scale to avoid vertical stretching; the bed is shown as a darker grey fill under the blue free-surface line.